# مخطط العلاقات بين الكيانات (ER Diagram) لنظام إدارة المستشفيات

## الكيانات الرئيسية

### 1. المرضى (Patients)
- **رقم المريض** (PatientID) - المفتاح الأساسي
- الاسم الأول (FirstName)
- الاسم الأخير (LastName)
- تاريخ الميلاد (DateOfBirth)
- الجنس (Gender)
- العنوان (Address)
- رقم الهاتف (PhoneNumber)
- البريد الإلكتروني (Email)
- فصيلة الدم (BloodType)
- تاريخ التسجيل (RegistrationDate)

### 2. الأطباء (Doctors)
- **رقم الطبيب** (DoctorID) - المفتاح الأساسي
- الاسم الأول (FirstName)
- الاسم الأخير (LastName)
- التخصص (Specialization)
- المؤهلات (Qualifications)
- رقم الهاتف (PhoneNumber)
- البريد الإلكتروني (Email)
- تاريخ التوظيف (HireDate)
- الراتب (Salary)
- **رقم القسم** (DepartmentID) - مفتاح أجنبي

### 3. الممرضون (Nurses)
- **رقم الممرض** (NurseID) - المفتاح الأساسي
- الاسم الأول (FirstName)
- الاسم الأخير (LastName)
- المؤهلات (Qualifications)
- رقم الهاتف (PhoneNumber)
- البريد الإلكتروني (Email)
- تاريخ التوظيف (HireDate)
- الراتب (Salary)
- **رقم القسم** (DepartmentID) - مفتاح أجنبي

### 4. الأقسام (Departments)
- **رقم القسم** (DepartmentID) - المفتاح الأساسي
- اسم القسم (DepartmentName)
- الوصف (Description)
- الموقع (Location)
- **رقم رئيس القسم** (HeadDoctorID) - مفتاح أجنبي (يشير إلى جدول الأطباء)

### 5. الغرف (Rooms)
- **رقم الغرفة** (RoomID) - المفتاح الأساسي
- نوع الغرفة (RoomType) - عادية، خاصة، عناية مركزة، غرفة عمليات
- الحالة (Status) - متاحة، مشغولة، تحت الصيانة
- التكلفة اليومية (DailyCost)
- **رقم القسم** (DepartmentID) - مفتاح أجنبي

### 6. المواعيد (Appointments)
- **رقم الموعد** (AppointmentID) - المفتاح الأساسي
- تاريخ الموعد (AppointmentDate)
- وقت الموعد (AppointmentTime)
- الحالة (Status) - مجدول، ملغى، مكتمل
- نوع الموعد (AppointmentType) - استشارة، متابعة، طوارئ
- **رقم المريض** (PatientID) - مفتاح أجنبي
- **رقم الطبيب** (DoctorID) - مفتاح أجنبي

### 7. الإقامة في المستشفى (Admissions)
- **رقم الإقامة** (AdmissionID) - المفتاح الأساسي
- تاريخ الدخول (AdmissionDate)
- تاريخ الخروج (DischargeDate) - قد يكون فارغاً إذا كان المريض لا يزال مقيماً
- سبب الإقامة (AdmissionReason)
- **رقم المريض** (PatientID) - مفتاح أجنبي
- **رقم الغرفة** (RoomID) - مفتاح أجنبي
- **رقم الطبيب المسؤول** (AttendingDoctorID) - مفتاح أجنبي

### 8. الأدوية (Medications)
- **رقم الدواء** (MedicationID) - المفتاح الأساسي
- اسم الدواء (MedicationName)
- الوصف (Description)
- الجرعة الموصى بها (RecommendedDosage)
- تعليمات الاستخدام (Instructions)
- السعر (Price)
- الكمية المتاحة (QuantityInStock)

### 9. الوصفات الطبية (Prescriptions)
- **رقم الوصفة** (PrescriptionID) - المفتاح الأساسي
- تاريخ الوصفة (PrescriptionDate)
- **رقم المريض** (PatientID) - مفتاح أجنبي
- **رقم الطبيب** (DoctorID) - مفتاح أجنبي

### 10. تفاصيل الوصفة (PrescriptionDetails)
- **رقم الوصفة** (PrescriptionID) - مفتاح أساسي، مفتاح أجنبي
- **رقم الدواء** (MedicationID) - مفتاح أساسي، مفتاح أجنبي
- الجرعة (Dosage)
- عدد مرات الاستخدام (Frequency)
- المدة (Duration)
- الكمية (Quantity)

### 11. الفحوصات المخبرية (LabTests)
- **رقم الفحص** (TestID) - المفتاح الأساسي
- اسم الفحص (TestName)
- الوصف (Description)
- التكلفة (Cost)

### 12. نتائج الفحوصات (TestResults)
- **رقم النتيجة** (ResultID) - المفتاح الأساسي
- تاريخ الفحص (TestDate)
- النتيجة (Result)
- التعليقات (Comments)
- **رقم المريض** (PatientID) - مفتاح أجنبي
- **رقم الفحص** (TestID) - مفتاح أجنبي
- **رقم الطبيب الطالب** (RequestingDoctorID) - مفتاح أجنبي

### 13. الفواتير (Bills)
- **رقم الفاتورة** (BillID) - المفتاح الأساسي
- تاريخ الفاتورة (BillDate)
- المبلغ الإجمالي (TotalAmount)
- حالة الدفع (PaymentStatus) - مدفوعة، غير مدفوعة، مدفوعة جزئياً
- طريقة الدفع (PaymentMethod) - نقداً، بطاقة ائتمان، تأمين
- **رقم المريض** (PatientID) - مفتاح أجنبي
- **رقم الإقامة** (AdmissionID) - مفتاح أجنبي (قد يكون فارغاً إذا كانت الفاتورة لخدمات خارجية)

### 14. تفاصيل الفاتورة (BillDetails)
- **رقم الفاتورة** (BillID) - مفتاح أساسي، مفتاح أجنبي
- **رقم البند** (ItemID) - مفتاح أساسي
- وصف البند (ItemDescription)
- الكمية (Quantity)
- سعر الوحدة (UnitPrice)
- المبلغ (Amount)

## العلاقات بين الكيانات

1. **الأطباء والأقسام**: علاقة متعددة إلى واحد (N:1) - كل طبيب ينتمي إلى قسم واحد، وكل قسم يضم العديد من الأطباء.

2. **الممرضون والأقسام**: علاقة متعددة إلى واحد (N:1) - كل ممرض ينتمي إلى قسم واحد، وكل قسم يضم العديد من الممرضين.

3. **الأقسام ورؤساء الأقسام**: علاقة واحد إلى واحد (1:1) - كل قسم له رئيس واحد، وكل طبيب يمكن أن يكون رئيساً لقسم واحد فقط.

4. **الغرف والأقسام**: علاقة متعددة إلى واحد (N:1) - كل غرفة تنتمي إلى قسم واحد، وكل قسم يضم العديد من الغرف.

5. **المرضى والمواعيد**: علاقة واحد إلى متعدد (1:N) - كل مريض يمكن أن يكون له العديد من المواعيد، وكل موعد يخص مريضاً واحداً.

6. **الأطباء والمواعيد**: علاقة واحد إلى متعدد (1:N) - كل طبيب يمكن أن يكون له العديد من المواعيد، وكل موعد يخص طبيباً واحداً.

7. **المرضى والإقامة**: علاقة واحد إلى متعدد (1:N) - كل مريض يمكن أن يكون له العديد من حالات الإقامة، وكل إقامة تخص مريضاً واحداً.

8. **الغرف والإقامة**: علاقة واحد إلى متعدد (1:N) - كل غرفة يمكن أن تستضيف العديد من حالات الإقامة (في أوقات مختلفة)، وكل إقامة تكون في غرفة واحدة.

9. **الأطباء والإقامة**: علاقة واحد إلى متعدد (1:N) - كل طبيب يمكن أن يكون مسؤولاً عن العديد من حالات الإقامة، وكل إقامة لها طبيب مسؤول واحد.

10. **المرضى والوصفات**: علاقة واحد إلى متعدد (1:N) - كل مريض يمكن أن يكون له العديد من الوصفات، وكل وصفة تخص مريضاً واحداً.

11. **الأطباء والوصفات**: علاقة واحد إلى متعدد (1:N) - كل طبيب يمكن أن يكتب العديد من الوصفات، وكل وصفة يكتبها طبيب واحد.

12. **الوصفات والأدوية**: علاقة متعددة إلى متعددة (N:M) - كل وصفة يمكن أن تحتوي على العديد من الأدوية، وكل دواء يمكن أن يظهر في العديد من الوصفات. (تم حل هذه العلاقة من خلال جدول تفاصيل الوصفة)

13. **المرضى ونتائج الفحوصات**: علاقة واحد إلى متعدد (1:N) - كل مريض يمكن أن يكون له العديد من نتائج الفحوصات، وكل نتيجة فحص تخص مريضاً واحداً.

14. **الفحوصات ونتائج الفحوصات**: علاقة واحد إلى متعدد (1:N) - كل فحص يمكن أن يكون له العديد من النتائج (لمرضى مختلفين)، وكل نتيجة تخص فحصاً واحداً.

15. **الأطباء ونتائج الفحوصات**: علاقة واحد إلى متعدد (1:N) - كل طبيب يمكن أن يطلب العديد من الفحوصات، وكل نتيجة فحص يطلبها طبيب واحد.

16. **المرضى والفواتير**: علاقة واحد إلى متعدد (1:N) - كل مريض يمكن أن يكون له العديد من الفواتير، وكل فاتورة تخص مريضاً واحداً.

17. **الإقامة والفواتير**: علاقة واحد إلى متعدد (1:N) - كل إقامة يمكن أن يكون لها العديد من الفواتير، وكل فاتورة يمكن أن تكون مرتبطة بإقامة واحدة (أو لا تكون مرتبطة بأي إقامة إذا كانت لخدمات خارجية).

18. **الفواتير وتفاصيل الفواتير**: علاقة واحد إلى متعدد (1:N) - كل فاتورة تحتوي على العديد من بنود التفاصيل، وكل بند تفصيلي ينتمي إلى فاتورة واحدة.

## قيود المشاركة

1. كل قسم يجب أن يكون له رئيس قسم (مشاركة إجبارية).
2. كل طبيب وممرض يجب أن ينتمي إلى قسم (مشاركة إجبارية).
3. كل موعد يجب أن يكون مرتبطاً بمريض وطبيب (مشاركة إجبارية).
4. كل إقامة يجب أن تكون مرتبطة بمريض وغرفة وطبيب مسؤول (مشاركة إجبارية).
5. كل وصفة يجب أن تكون مرتبطة بمريض وطبيب (مشاركة إجبارية).
6. كل نتيجة فحص يجب أن تكون مرتبطة بمريض وفحص وطبيب طالب (مشاركة إجبارية).
7. كل فاتورة يجب أن تكون مرتبطة بمريض (مشاركة إجبارية)، ولكن ليس بالضرورة بإقامة (مشاركة اختيارية).
